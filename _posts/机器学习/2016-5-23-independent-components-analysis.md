---
layout: single
title: "独立成分分析"
subtitle: "斯坦福大学机器学习第十二讲"
date: 2016-5-23
author: "Anyinlover"
mathjax: true
category: 机器学习
tags:
  - Ng机器学习系列
  - 机器学习理论
---

考虑一个鸡尾酒派对，不同位置的n个麦克风记录了n个说话者的声音。我们的目标是区分原始n个说话者的信号。

用公式来表达，假设有一些数据$$s \in {\mathbb{R}}^n$$通过n各独立源产生，我们观察到的是：

$$ x = As $$

这里A是一个未知的方矩阵被称为混合矩阵。重复观察可以得到数据集$$ \{x^{(i)};i=1,\cdots,m\} $$，目标就是还原源数据$$s^{(i)}$$。

令$$W = A^{-1}$$为分离矩阵，我们的目标变成找到W,因为$$s^{(i)}=Wx^{(i)}$$。令$$w_i^T$$表示W的第i行，则$$s_j^{(i)}=w_j^Tx^{(i)}$$。

## ICA的任意性

如果对源和混合矩阵没有任何先验知识，只是给出$$x^{(i)}$$，容易看出A是具有一些任意性的。

如果P是任意一个$$n \times n$$的重排列矩阵，这意味这每一行每一列都只包含一个1，那么我们是无法区分W和PW的，因为源数据的排列次序不会影响观察到的x。

同样的，对W进行系数的缩放也没有影响。

对于非高斯分布的数据源而言，只存在上面两种任意性。如果数据源是高斯分布的，考虑下面的例子。$$n=2, s \sim \mathcal{N}(0,I)$$。那么对于观察数据$$x=As$$而言，x也是一个高斯分布，平均值为0，方差为$$E[xx^T]=E[Ass^TA^T]=AA^T$$。现在令R是任意一个正交矩阵，即$$RR^T=R^TR=I$$，则有$$A'=AR$$，当混合矩阵是$$A'$$时，我们观察到$$x'=A's$$。$$x'$$的分布同样属于高斯分布，平均值为0，方差为$$E[x'{x'}^T]=E[A'ss^T{A'}^T]=E[ARss^T(AR)^T]=ARR^TA^T=AA^T$$。也就是无论混合矩阵是A还是$$A'$$，最终观察到的都是$$\mathcal{N}(0,AA^T)$$的分布。

上述讨论是建立在对称的标准多变量正态分布上的，尽管ICA不能在高斯分布数据中应用，在实际应用于非高斯分布数据中，只要数据足够多，是可以还原成n个独立源的。

## 分布密度和线性转换

假设随机变量s的分布密度是$$p_s(s)$$，那么x的分布密度$$p_x$$可以用下式表示：

$$p_x(x)=p_s(Wx)\cdot | W |$$

## ICA算法

假设每个数据源$$s_i$$的分布由分布密度$$p_s$$给出，则s的联合分布由下式给出：

$$p(s) = \prod_{i=1}^n p_s(s_i)$$

也可以得到$$x=As=W^{-1}s$$的分布密度：

$$p(x) = \prod_{i=1}^n p_s(w_i^Tx) \cdot |W|$$

回顾累积分布函数(cdf)的定义，$$F(z_0)=P(z \leq z_0)= \int_{-\infty}^{z_0} p_z(z)dz$$，z的分布密度也可以通过求导得到$$p_z(z)=F'(z)$$。

因此，要确定s的分布密度，只需要确定cdf，它从0增长到1。根据我们上面的讨论，cdf不能取高斯函数，我们选择S型函数$$g(s)=1/(1+e^{-s})$$，（假如对源分布有先验知识，这里应该利用先验知识构建cdf）。

方矩阵W是模型的参数，给定训练集$$\{x^{(i)};i=1,\cdots,m\}$$，对数似然函数是：

$$\ell(W) = \sum_{i=1}^m \left( \sum_{j=1}^n \log g'(w_j^Tx^{(i)}) + \log |W| \right)$$

使用随机梯度上升法则更新W，对于一个训练样本$$x^{(i)}$$，更新规则是：

$$ W := W + \alpha \left(
\begin{bmatrix}
1-2g(w_1^Tx^{(i)}) \\
1-2g(w_2^Tx^{(i)}) \\
\vdots \\
1-2g(w_n^Tx^{(i)})\\
\end{bmatrix}
{x^{(i)}}^T + (W^T)^{-1} \right)$$

上面的推导包含了样本独立分布的假设，因此可以直接来最大化$$\prod_i p(x^{(i)}; W)$$。但实际上说话者案例中样本并非完全独立，它们是时间相关的。但假如样本数足够多，ICA算法仍然有效。事实上，当样本具有相关性时，有时候还帮助我们加快拟合，类似于随机排序功能。
