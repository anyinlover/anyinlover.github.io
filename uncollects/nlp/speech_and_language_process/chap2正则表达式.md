# Chap2 正则表达式与文本规范化

本章主要介绍正则表达式和文本规范化，是NLP文本预处理的基础知识。

## 正则表达式

正则表达式从linux的grep开始兴起，是一种强有力的文本匹配搜索工具。正则表达式在算法中的实现一般是通过有限状态自动机实现的。正则表达式大致分三类语法，basic，extended和ECMAScript，这里介绍功能和复杂度比较均衡的extended语法。

### 基本语法

| RE | Match | Examples |
|--- | ------| ---------|
| LICENSE | 字面匹配 | LICENSE  |
| [Ll]icense | 中括号内可选匹配 | license |
| [a-z]opy | 小写字母匹配 | copy |
| [^a-g]his | 非a-g匹配 | this |
| alloweds? | 可有可无匹配 | allowded |
| doc.ment | 任意字符匹配 | document |
| ^GNU | 行首定位匹配 | GNU |
| allowed.$ | 行尾定位匹配 | allowed |
| \bis | 单词边界匹配 | is |
| \Bis | 非单词边界匹配 | is |

### 或语法、分组和顺序

| RE | Match | Examples |
|--- | ------| ---------|
| copy\|but | 匹配copy或but | copy |
| cop(y\|ies) | 匹配copy或copies | copy |

正则表达式执行顺序

1. 括号 ()
2. 计数 * + ？ {}
3. 序列和定位 the ^my end$
4. 或 |

### 其他操作

| RE | Match | Examples |
|--- | ------| ---------|
| \d | 任何数字 | 5 |
| \D | 任何非数字 | B |
| \w | 任何字母数字或下划线 | D |
| \W | 任何非字母数字或下划线 | ! |
| \s | 空格，包括制表符、换行符等 |     |
| \S | 非空格 | i |

| RE | Match | Examples |
|--- | ------| ---------|
| a* | 匹配零个或多个 | aaa |
| b+ | 匹配一个或多个 | bb |
| c? | 匹配零个或一个 | c |
| d{2} | 匹配两次 | dd |
| e{3, 5} | 匹配三到五次 | eeee |
| f{3,} | 匹配至少三次 | ffff |
| g{,2} | 匹配至多两次 | g |

其他特殊字符需要转义，除了正则表达式里有特殊含义的字符外，还包括\n \t等。

### 预判断

预判断和非捕捉分组有点类似，使用?= ?!来判断是否满足条件，但不会纳入捕捉中

## 词

在不同的应用场景下，对词的定义会发生变化。

比如在大部分场景下，停顿词是可以忽略的，但有时候停顿词可以用来辅助判断不同的含义。

在阿拉伯语中，词往往需要做词干化，而在英语中，普通词形就够用了。

对于一个语料库而言，一般来说满足下面的赫尔丹定律，其中$|V|$表示不同的词元数量，$N$表示总的词元数量：

$$
|V| = kN^\beta
$$

对于大的语料库而言，$\beta$一般在0.67到0.75之间。

## 语料库

语料库有不同的属性。

第一个重要的维度就是语言，比如非洲英语跟主流英语就有明显的差异。

另外一个重要的维度是类别。不同类别的语料库有非常不同的分布。比如新闻、小说、法律文本就完全不同。

其他影响语料库的维度包括写作者、年龄、性别、种族、经济阶层以及时间等。

了解一个语料库最好要建一份档：

1. 动机：为什么要收集这个语料库，谁收集的，谁资助的？
2. 情境：什么情境下文本生成的。是有什么任务？是原始口语、被编辑过的文本、社媒交流、独白或者对话？
3. 语言类别：什么语言（包括方言和地区）
4. 写作者属性：年龄、性别等。
5. 收集过程：数据量有多大？如果是抽样的那么抽样方法是什么？是否被赞同收集？数据如何预处理的？元数据是否存在？
6. 分发：是否有版权或其他权限限制。

## 文本规范化

### Unix工具进行分词和规范化

下面的命令可以实现分词，并且大写变成小写，之后按计数排序，用于快速的处理和查看语料库

`tr -sc ’A-Za-z’ ’\n’ < sh.txt | tr A-Z a-z | sort | uniq -c | sort -n -r`

### 分词和规范化

## 编辑距离

一个字符串通过插入、删除、替换三种方式转换为另一个字符串，过程中的损耗被称为编辑距离。下面我们用动态规划实现莱文斯坦距离，其中插入和删除cost为1，替换cost为2。力扣72有一题类似题目，不过所有cost都是1
