# 向量语义和嵌入

向量语义基于这样一个分布假设：处于类似上下文的词更可能有相近的含义。

向量语义就是这种语言假设的实例，通过直接学习词在文本中的分布来得到词含义的表示--嵌入。词嵌入包括静态嵌入和动态嵌入。动态嵌入就是BERT的做法，这章主要介绍静态嵌入。

词嵌入也是表征学习的一个例子。通过自监督学习表征，而不是通过特征工程，是NLP的一个重点研究方向。

## 词汇语义学

词汇语义学通过语言学来研究词汇的含义特点。

从词典角度出发，sing、sang、sung这三个词有一个共同的词目（lemma）sing，这三个词被称为词形（wordforms）。词典是通过词目来做解释的。从词形到词目的映射被称为词形还原。

同一个词目可能具有不同的词义（word sense），比如mouse既可以表示老鼠，也可以表示鼠标。这种情况被称为多义。

同义关系：如果两个词在任意句子中可以互相替换，且不影响句子真值条件，我们通常称这种情况下两个词有相同的命题意义（propositional meaning)。比如car/automobile。但要注意的是，语义学的基础信条之一对比原则认为不可能有两个词有完全相同的语义，本章的同义词更限定在上下文中同义即可。

词的相似度（similarity）衡量的是两个词之间的含义相似度。词的相似度对于判断段落和句子的相似度有很大的作用。

词的相关性 （relatedness）衡量两个词之间的相关度。一种很常见的相关性是两个词同属于一个语义场。语义场是属于一个语义域的一组词构成。与之相关的一个概念是话题模型，比如LDA，通过无监督学习自动推导出语义场。

词的隐含意义（Connotation）表示词内涵的作者的情感、观点等。其中对于正面或负面评价判定是一项重要的NLP任务--情感分析。

早期研究认为感情意义有三个维度：配价（表示愉悦程度）、激励（表示情绪强度）、支配性（表示被控制度）。通过三个数字来表示感情意义的词，这是第一个具有开创性的向量意义模型。

## 向量语义学

语义向量由两种思想结合而成，第一个就是上面提的三维度感情词。第二个是开头提到的分布假设。

通过向量语义的相似度计算，可以增强很多NLP应用的能力。比如之前介绍的文本分类任务都以来相同的词出现在训练集和测试集中，但通过词嵌入表示只需要依赖相似度。

## 词和向量

单词-文档矩阵中，每一行表示词库中的一个单词，每一列表示文档集中的一个文档。每一个值表示此文档中此单词出现的次数。这样每个列向量可以表示一个文档，最早应用在信息检索领域中用于表示文档相似度。类似的，每个行向量可以表示一个单词，相似的单词也会有相似的行向量。

在单词-单词矩阵中，每一列也是一个单词，通过一个小窗口（一般是单词前四个和后四个）来判定两个单词是否一块出现。这样矩阵的形状就是$|V| * |V|$，其中$|V|$是词库词条数目，一般在10000-50000之间。

## Cosine衡量相似度

标准衡量相似度的方法就是cosine法。

$$cosine(\bold{v}, \bold{w}) = \frac{\bold{v} \cdot \bold{w}}{|\bold{v}||\bold{v}|} = \frac{\sum_{i=1}^N v_iw_i}{\sum_{i=1}^N v_i^2\sum_{i=1}^N w_i^2}$$

## TF-IDF

上面的单词-文档矩阵表示中，是用单词频度来表示值，但在实际使用中，经常出现的那些单词反而是不重要的，而那些频度低的单词却更重要。TF-IDF就是用来解决这个问题。

TF-IDF由两部分组成，TF与上面的单词-文档矩阵类似，衡量了这个单词在这个文档中的频度。这里用了对数转换，是一个常用的做法。

$$ tf_{t,d} = \log_{10}(count(t,d) + 1) $$

IDF衡量的是单词在不同文档中出现的次数情况。df_t表示总共这个单词出现在多少个不同的文档中。

$$ idf_t = \log_{10}(\frac{N}{df_t}) $$

最后我们得到tf-idf值：

$$ w_{t,d} = tf_{t,d} * idf_t $$

## PMI

相对于TF-IDF应用在单词-文档矩阵中，PMI应用在单词-单词矩阵中。定义目标词与上下文词之间的点互信息为：

$$ PMI(w,c) = \log_2 \frac{P(w,c)}{P(w)P(c)} $$

其中分子是两个单词同时出现的概率，分母是两个单词单独出现的概率。由概率论可知，当两个单词相互独立时，分子就等于分母，这时PMI为0。由于负的PMI对于语料库数量和人工评估准确度要求非常高，所以一般只取正值。

$$ PPMI(w,c) = \max(\log_2 \frac{P(w,c)}{P(w)P(c)}, 0) $$

## Word2vec

## 嵌入可视化

## 嵌入的语义属性

## 偏差和嵌入

## 评估向量模型

向量模型最重要的评估方式是通过某个NLP任务进行外在评估。
